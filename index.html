<!doctype html>
<html>

<head>
    <title>Images - NIS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font: 13px Helvetica, Arial;
            text-align: center;
        }
        button {
            width: 20%;
            height: 25px;
            cursor: pointer;
        }
        .bbutton {
            width: 33%;
        }
        #folders {
            height: 25px;
        }
    </style>
</head>

<body>
    <span id="folders"></span>
    <canvas id="catchit">
        <p>Your browser does not support the canvas tag.</p>
    </canvas>
    <br>
    <button class="bbutton" style="float:left;"onclick='socket.emit("prev",tag)'>Prev</button>
    <button class="bbutton" style="float:center;"onclick='tag="DELETE"'>Delete</button>
    <button class="bbutton" style="float:right;"onclick='socket.emit("next",tag)'>Next</button>
    <script src="/socket.io/socket.io.js"></script>
    <script src="jquery-1.11.1.js"></script>
    <script>
        // variables to determine canvas pixel size
        let can, ctx, ww, hh, width, height;
        
        let tag='';
        let folderRow=1;

        let socket = io();

        socket.on('connect', function (data) {
            socket.emit('getimage', '');
        });

        socket.on('image',function(i) {
            tag='';
        });

        socket.on('folders',function(f) {
            document.getElementById("folders").innerHTML="";
            for (let i=0;i<f.length;i++) {
                document.getElementById("folders").innerHTML+=`<button onclick='tag="${f[i]}";'>${f[i]}</button>`
            }
            folderRow=Math.ceil(f.length/5);
            resize();
        });

        function resize() {
            ww = window.innerWidth;
            hh = window.innerHeight;

            width = ww;
            height = hh - 10 - 25 - 25*folderRow;

            $("#catchit").attr("width", width);
            $("#catchit").attr("height", height);
            $("#catchit").css({ "width": width });
            $("#catchit").css({ "height": height });

            ctx.fillStyle = "#215968;";
            ctx.fillRect(0, 0, width, height);
        }

        $(document).ready(function () {
            can = document.getElementById("catchit");
            ctx = can.getContext("2d");

            $(window).resize(function () {
                resize();
            });
            $(window).bind("load", function () {
                resize();
            });
        });
    </script>
</body>

</html>